deptrac:
  paths:
    - ./app/Domains
  exclude_files:
    - 'vendor/.*'

  layers:
    # Shared contracts and DTOs - accessible by all domains
    - name: Shared
      collectors:
        - type: directory
          value: 'app/Domains/Shared/'

    # Test helpers - can be shared between domain tests
    - name: TestHelpers
      collectors:
        - type: directory
          value: 'app/Domains/Shared/Testing/'

    # Admin Domain
    - name: AdminPrivate
      collectors:
        - type: bool
          must_not:
            - type: directory
              value: app/Domains/Admin/Tests/
          must:
            - type: directory
              value: app/Domains/Admin/

    - name: AdminTests
      collectors:
        - type: directory
          value: 'app/Domains/Admin/Tests/'

    # Auth Domain
    - name: AuthPublic
      collectors:
        - type: directory
          value: 'app/Domains/Auth/Public/Api/'
        - type: directory
          value: 'app/Domains/Auth/Public/Events/'

    - name: AuthPrivate
      collectors:
        - type: bool
          must_not:
            - type: directory
              value: app/Domains/Auth/Public/
            - type: directory
              value: app/Domains/Auth/Tests/
          must:
            - type: directory
              value: app/Domains/Auth/

    - name: AuthTests
      collectors:
        - type: directory
          value: 'app/Domains/Auth/Tests/'

    # Comment Domain
    - name: CommentPublic
      collectors:
        - type: directory
          value: 'app/Domains/Comment/Public/'

    - name: CommentPrivate
      collectors:
        - type: directory
          value: app/Domains/Comment/Private/

    - name: CommentTests
      collectors:
        - type: directory
          value: 'app/Domains/Comment/Tests/'

    # Calendar domain
    - name: CalendarPublic
      collectors:
        - type: directory
          value: 'app/Domains/Calendar/Public/'

    - name: CalendarPrivate
      collectors:
        - type: directory
          value: app/Domains/Calendar/Private/

    - name: CalendarTests
      collectors:
        - type: directory
          value: app/Domains/Calendar/Tests/

    # Config Domain
    - name: ConfigPublic
      collectors:
        - type: directory
          value: 'app/Domains/Config/Public/'

    - name: ConfigPrivate
      collectors:
        - type: directory
          value: app/Domains/Config/Private/

    - name: ConfigTests
      collectors:
        - type: directory
          value: app/Domains/Config/Tests/

    # Dashboard Domain
    - name: DashboardPublic
      collectors:
        - type: directory
          value: 'app/Domains/Dashboard/Public/'

    - name: DashboardPrivate
      collectors:
        - type: directory
          value: app/Domains/Dashboard/Private/

    # Events domains
    - name: EventsPublic
      collectors:
        - type: directory
          value: app/Domains/Events/Public/
        
    - name: EventsPrivate
      collectors:
        - type: directory
          value: app/Domains/Events/Private/

    - name: EventsTests
      collectors:
        - type: directory
          value: app/Domains/Events/Tests/

    # FAQ domains
    - name: FaqPublic
      collectors:
        - type: directory
          value: app/Domains/FAQ/Public/

    - name: FaqPrivate
      collectors:
        - type: directory
          value: app/Domains/FAQ/Private/

    - name: FaqTests
      collectors:
        - type: directory
          value: app/Domains/FAQ/Tests/

    # Home Domain
    - name: HomePublic
      collectors:
        - type: directory
          value: 'app/Domains/Home/Public/'

    - name: HomePrivate
      collectors:
        - type: directory
          value: app/Domains/Home/Private/

    # Message Domain
    - name: MessagePublic
      collectors:
        - type: directory
          value: app/Domains/Message/Public/

    - name: MessagePrivate
      collectors:
        - type: directory
          value: app/Domains/Message/Private/

    - name: MessageTests
      collectors:
        - type: directory
          value: app/Domains/Message/Tests/

    #Moderation Domain
    - name: ModerationPublic
      collectors:
        - type: directory
          value: 'app/Domains/Moderation/Public/'

    - name: ModerationPrivate
      collectors:
        - type: directory
          value: app/Domains/Moderation/Private/

    - name: ModerationTests
      collectors:
        - type: directory
          value: app/Domains/Moderation/Tests/

    # News Domain
    - name: NewsPublic
      collectors:
        - type: directory
          value: 'app/Domains/News/Public/'

    - name: NewsPrivate
      collectors:
        - type: directory
          value: app/Domains/News/Private/

    - name: NewsTests
      collectors:
        - type: directory
          value: 'app/Domains/News/Tests/'

    # Notification Domain
    - name: NotificationPublic
      collectors:
        - type: directory
          value: 'app/Domains/Notification/Public/'

    - name: NotificationPrivate
      collectors:
        - type: directory
          value: app/Domains/Notification/Private/

    - name: NotificationTests
      collectors:
        - type: directory
          value: app/Domains/Notification/Tests/

    # Profile Domain
    - name: ProfilePublic
      collectors:
        - type: directory
          value: 'app/Domains/Profile/Public/'

    - name: ProfilePrivate
      collectors:
        - type: directory
          value: 'app/Domains/Profile/Private/'

    - name: ProfileTests
      collectors:
        - type: directory
          value: 'app/Domains/Profile/Tests/'

    # ReadList Domain
    - name: ReadListPublic
      collectors:
        - type: directory
          value: 'app/Domains/ReadList/Public/'

    - name: ReadListPrivate
      collectors:
        - type: directory
          value: 'app/Domains/ReadList/Private/'

    - name: ReadListTests
      collectors:
        - type: directory
          value: 'app/Domains/ReadList/Tests/'

    # StaticPage Domain
    - name: StaticPagePublic
      collectors:
        - type: directory
          value: 'app/Domains/StaticPage/Public/'

    - name: StaticPagePrivate
      collectors:
        - type: directory
          value: app/Domains/StaticPage/Private/

    - name: StaticPageTests
      collectors:
        - type: directory
          value: 'app/Domains/StaticPage/Tests/'

    # Story Domain
    - name: StoryPublic
      collectors:
        - type: directory
          value: 'app/Domains/Story/Public/'

    - name: StoryPrivate
      collectors:
        - type: directory
          value: 'app/Domains/Story/Private/'

    - name: StoryTests
      collectors:
        - type: directory
          value: 'app/Domains/Story/Tests/'

    - name: StoryRefPublic
      collectors:
        - type: directory
          value: app/Domains/StoryRef/Public/

    - name: StoryRefPrivate
      collectors:
        - type: directory
          value: app/Domains/StoryRef/Private/

    - name: StoryRefTests
      collectors:
        - type: directory
          value: app/Domains/StoryRef/Tests/

  ruleset:
    # Shared contracts and DTOs - accessible by all domains
    Shared: [ ]

    # Test helpers - accessible by all domain tests
    TestHelpers: [ ]

    # ###################################################
    # Public APIs - can only depend on Shared and their own domain
    # ###################################################
    AuthPublic:
      - Shared
      - AuthPrivate
      - EventsPublic

    CalendarPublic:
      - Shared
      - CalendarPrivate
      - AuthPublic

    CommentPublic: 
      - Shared
      - AuthPublic
      - CommentPrivate
      - EventsPublic
      - ModerationPublic

    ConfigPublic:
      - Shared
      - ConfigPrivate
      - EventsPublic
      - AuthPublic

    DashboardPublic:
      - Shared
      - DashboardPrivate

    EventsPublic:
      - Shared
      - EventsPrivate

    FaqPublic:
      - Shared
      - FaqPrivate
      - AuthPublic

    HomePublic:
      - Shared
      - HomePrivate

    MessagePublic:
      - Shared
      - MessagePrivate
      - EventsPublic

    ModerationPublic:
      - Shared
      - ModerationPrivate
      - EventsPublic
      - AuthPublic

    NewsPublic:
      - AuthPublic
      - Shared
      - NewsPrivate
      - EventsPublic

    NotificationPublic:
      - Shared
      - NotificationPrivate
      - AuthPublic
      - EventsPublic

    ProfilePublic:
      - Shared
      - ProfilePrivate
      - AuthPublic
      - EventsPublic
      - ModerationPublic

    ReadListPublic:
      - Shared
      - ReadListPrivate
      - AuthPublic
      - EventsPublic

    StaticPagePublic:
      - AuthPublic
      - Shared
      - StaticPagePrivate
      - EventsPublic

    StoryPublic:
      - CommentPublic
      - Shared
      - StoryPrivate
      - StoryRefPublic
      - StoryRefPrivate
      - EventsPublic
      - AuthPublic
      - ModerationPublic
      - NotificationPublic

    StoryRefPublic:
      - Shared
      - EventsPublic
      - StoryRefPrivate

    # ###################################################
    # Private domains - can access Shared + other domain Public APIs + events
    # ###################################################

    # [Exception] Admin can use both Public and Private parts
    # This is because the Admin dashboards are centered in this module
    # But they actually could be spread in their own modules
    AdminPrivate:
      - Shared
      - AuthPublic
      - AuthPrivate
      - NewsPublic
      - NewsPrivate
      - ProfilePublic
      - ProfilePrivate
      - StaticPagePublic
      - StaticPagePrivate
      - StoryPublic
      - StoryPrivate
      - StoryRefPublic
      - StoryRefPrivate
      - HomePrivate
      - EventsPublic
      - EventsPrivate
      - ConfigPublic
      - ConfigPrivate
      - ModerationPublic
      - ModerationPrivate
      - FaqPublic
      - FaqPrivate
      - CalendarPublic
      - CalendarPrivate

    AuthPrivate:
      - Shared
      - AuthPublic
      - EventsPublic

    CalendarPrivate:
      - Shared
      - CalendarPublic
      - AuthPublic
      - StoryPublic
      - EventsPublic
 
    CommentPrivate:
      - Shared
      - AuthPublic
      - CommentPublic
      - EventsPublic
      - ModerationPublic

    ConfigPrivate:
      - Shared
      - ConfigPublic

    DashboardPrivate:
      - Shared
      - AuthPublic
      - NewsPublic
      - ProfilePublic
      - StoryPublic
      - CommentPublic
      - ConfigPublic

    EventsPrivate:
      - Shared
      - EventsPublic

    FaqPrivate:
      - Shared
      - FaqPublic

    HomePrivate:
      - Shared
      - AuthPublic
      - NewsPublic

    MessagePrivate:
      - Shared
      - AuthPublic
      - MessagePublic
      - EventsPublic
      - ConfigPublic

    ModerationPrivate:
      - Shared
      - ModerationPublic
      - AuthPublic
      - EventsPublic

    NewsPrivate:
      - Shared
      - AuthPublic
      - EventsPublic
      - NewsPublic

    NotificationPrivate:
      - Shared
      - NotificationPublic
      - EventsPublic

    ProfilePrivate:
      - Shared
      - AuthPublic
      - EventsPublic
      - ModerationPublic
      - ProfilePublic

    ReadListPrivate:
      - Shared
      - ReadListPublic
      - AuthPublic
      - EventsPublic
      - StoryPublic

    StaticPagePrivate:
      - Shared
      - AuthPublic
      - EventsPublic
      - StaticPagePublic

    StoryPrivate:
      - Shared
      - AuthPublic
      - CommentPublic
      - ModerationPublic
      - ProfilePublic
      - StoryRefPrivate
      - EventsPublic
      - StoryPublic
      - NotificationPublic

    StoryRefPrivate:
      - Shared
      - EventsPublic
      - StoryRefPublic

    # ###################################################
    # Domain tests - can access their own domain + Public APIs + ALL test modules for data creation
    # ###################################################
    AuthTests:
      - Shared
      - TestHelpers
      - AuthPrivate
      - AuthPublic

    CalendarTests:
      - TestHelpers
      - CalendarPrivate
      - CalendarPublic
      - AuthPublic
      - StoryPublic
      - ProfilePublic
      - Shared

    CommentTests:
      - TestHelpers
      - CommentPrivate
      - CommentPublic

    ConfigTests:
      - TestHelpers
      - ConfigPrivate
      - ConfigPublic

    EventsTests:
      - TestHelpers
      - EventsPrivate
      - EventsPublic

    FaqTests:
      - TestHelpers
      - FaqPrivate
      - FaqPublic

    MessageTests:
      - TestHelpers
      - MessagePrivate
      - MessagePublic

    ModerationTests:
      - TestHelpers
      - ModerationPrivate
      - ModerationPublic

    NewsTests:
      - Shared
      - TestHelpers
      - NewsPrivate
      - NewsPublic
      - AuthPublic

    NotificationTests:
      - TestHelpers
      - NotificationPrivate
      - NotificationPublic

    ProfileTests:
      - Shared
      - TestHelpers
      - ProfilePrivate
      - ProfilePublic
      - AuthPublic

    ReadListTests:
      - TestHelpers
      - ReadListPrivate
      - ReadListPublic

    StaticPageTests:
      - Shared
      - TestHelpers
      - StaticPagePrivate
      - StaticPagePublic
      - AuthPublic

    StoryTests:
      - Shared
      - TestHelpers
      - StoryPrivate
      - StoryPublic
      - AuthPublic
      - ProfilePublic
      - StoryRefPublic
      - StoryRefPrivate

    AdminTests:
      - Shared
      - TestHelpers
      - AdminPrivate
      - AuthPublic
      - NewsPublic
      - ProfilePublic
      - StaticPagePublic
      - StoryPublic
      - StoryRefPublic
      - StoryRefPrivate
